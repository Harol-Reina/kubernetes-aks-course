# Resource Field References - LÃ­mites y Requests
apiVersion: v1
kind: Pod
metadata:
  name: resource-ref-demo
spec:
  containers:
  - name: app
    image: busybox
    command: ["sh", "-c", "env | grep -E '(CPU|MEM)' && sleep 3600"]
    
    # Definir recursos
    resources:
      requests:
        cpu: "100m"
        memory: "128Mi"
      limits:
        cpu: "500m"
        memory: "512Mi"
    
    env:
    # CPU Request (en milicores)
    - name: MY_CPU_REQUEST
      valueFrom:
        resourceFieldRef:
          containerName: app
          resource: requests.cpu
    
    # CPU Limit (en milicores)
    - name: MY_CPU_LIMIT
      valueFrom:
        resourceFieldRef:
          containerName: app
          resource: limits.cpu
    
    # Memory Request (convertida a MiB)
    - name: MY_MEM_REQUEST
      valueFrom:
        resourceFieldRef:
          containerName: app
          resource: requests.memory
          divisor: "1Mi"  # Convertir a MiB
    
    # Memory Limit (convertida a MiB)
    - name: MY_MEM_LIMIT
      valueFrom:
        resourceFieldRef:
          containerName: app
          resource: limits.memory
          divisor: "1Mi"
    
    # Memory Request en bytes (default)
    - name: MY_MEM_REQUEST_BYTES
      valueFrom:
        resourceFieldRef:
          containerName: app
          resource: requests.memory
